<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PGXL - Premium Growth Expansion Lab</title>
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <style>
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --accent: #00bcd4;
            --white: #ffffff;
            --light: #f8f9fa;
            --dark: #202124;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); color: var(--dark); }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 20px; }
        
        /* Header */
        header { background: var(--white); box-shadow: 0 2px 10px rgba(0,0,0,0.1); position: sticky; top: 0; z-index: 1000; }
        .navbar { display: flex; justify-content: space-between; align-items: center; padding: 20px 0; }
        .logo { font-size: 1.8rem; font-weight: 700; color: var(--primary-dark); text-decoration: none; }
        
        /* Hero */
        .hero { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); color: var(--white); padding: 100px 0; text-align: center; }
        .hero h1 { font-size: 3rem; margin-bottom: 20px; }
        
        /* Features */
        .features-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 30px; margin-top: 40px; }
        .feature-card { background: var(--white); padding: 30px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        .feature-icon { width: 60px; height: 60px; background: var(--primary); border-radius: 50%; display: flex; align-items: center; justify-content: center; margin-bottom: 20px; color: var(--white); font-size: 1.5rem; }
        
        /* Auth */
        .auth-container { max-width: 400px; margin: 0 auto; background: var(--white); padding: 40px; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 20px; }
        .form-control { width: 100%; padding: 12px 15px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
        
        /* Button */
        .btn { display: inline-block; background: var(--primary); color: var(--white); padding: 12px 24px; border: none; border-radius: 8px; font-size: 1rem; cursor: pointer; text-decoration: none; }
        .btn:hover { background: var(--primary-dark); }
        
        /* Dashboard */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 25px; margin-top: 40px; }
        .stat-card { background: var(--white); padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); text-align: center; }
        
        /* Footer */
        footer { background: var(--dark); color: var(--white); padding: 40px 0 20px; margin-top: 50px; }
        
        /* Responsive */
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.2rem; }
            .navbar { flex-direction: column; gap: 20px; }
            .auth-container { padding: 30px 20px; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="container">
            <nav class="navbar">
                <div class="logo">ðŸš€ PGXL</div>
                <div id="navButtons"></div>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <div id="mainContent">
        <!-- Content akan diisi oleh JavaScript -->
    </div>

    <!-- Footer -->
    <footer>
        <div class="container">
            <p style="text-align: center; color: #94a3b8;">&copy; <span id="currentYear"></span> PGXL - Premium Growth Expansion Lab</p>
        </div>
    </footer>

    <!-- Firebase Config -->
    <script type="module">
        // Import Firebase Config dari file terpisah
        import firebaseConfig from './firebase-config.json' assert { type: 'json' };
        
        // Inisialisasi Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();
        const auth = firebase.auth();
        const storage = firebase.storage();
        
        // Variabel global
        let currentUser = null;
        
        // Main App
        document.addEventListener('DOMContentLoaded', function() {
            // Auth State Listener
            auth.onAuthStateChanged((user) => {
                currentUser = user;
                renderApp();
            });
            
            // Render initial app
            renderApp();
            updateCopyrightYear();
        });
        
        // Render App berdasarkan auth state
        function renderApp() {
            const mainContent = document.getElementById('mainContent');
            const navButtons = document.getElementById('navButtons');
            
            if (currentUser) {
                // User logged in
                navButtons.innerHTML = `
                    <div style="display: flex; gap: 10px;">
                        <span style="color: var(--primary); font-weight: 500;">${currentUser.email}</span>
                        <button class="btn" onclick="logout()">Logout</button>
                    </div>
                `;
                
                mainContent.innerHTML = `
                    <section class="hero">
                        <div class="container">
                            <h1>Welcome to PGXL Dashboard</h1>
                            <p>Hi ${currentUser.email}, you're logged in!</p>
                            <button class="btn" onclick="showDashboard()" style="margin-top: 20px;">Go to Dashboard</button>
                        </div>
                    </section>
                `;
            } else {
                // User not logged in
                navButtons.innerHTML = `
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" onclick="showLogin()">Login</button>
                        <button class="btn" onclick="showRegister()" style="background: transparent; border: 2px solid var(--primary); color: var(--primary);">Register</button>
                    </div>
                `;
                
                mainContent.innerHTML = `
                    <section class="hero">
                        <div class="container">
                            <h1>PGXL Platform</h1>
                            <p>Premium Growth Expansion Lab with Firebase Backend</p>
                            <button class="btn" onclick="showLogin()" style="margin-top: 20px;">Get Started</button>
                        </div>
                    </section>
                    
                    <section style="padding: 80px 0;">
                        <div class="container">
                            <h2 style="text-align: center; margin-bottom: 40px;">Features</h2>
                            <div class="features-grid">
                                <div class="feature-card">
                                    <div class="feature-icon">ðŸ”¥</div>
                                    <h3>Firebase Auth</h3>
                                    <p>Secure authentication with email/password and Google login.</p>
                                </div>
                                <div class="feature-card">
                                    <div class="feature-icon">ðŸ’¾</div>
                                    <h3>Firestore DB</h3>
                                    <p>Real-time NoSQL database for your data storage needs.</p>
                                </div>
                                <div class="feature-card">
                                    <div class="feature-icon">âš¡</div>
                                    <h3>Fast & Secure</h3>
                                    <p>Built with modern web technologies for optimal performance.</p>
                                </div>
                            </div>
                        </div>
                    </section>
                `;
            }
        }
        
        // Auth Functions
        function showLogin() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 80px 0;">
                    <div class="container">
                        <div class="auth-container">
                            <h2 style="text-align: center; margin-bottom: 30px;">Login</h2>
                            <form onsubmit="handleLogin(event)">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" id="loginEmail" class="form-control" placeholder="email@example.com" required>
                                </div>
                                <div class="form-group">
                                    <label>Password</label>
                                    <input type="password" id="loginPassword" class="form-control" placeholder="Enter password" required>
                                </div>
                                <button type="submit" class="btn" style="width: 100%;">Login</button>
                            </form>
                            <p style="text-align: center; margin-top: 20px;">Don't have an account? <a href="#" onclick="showRegister()" style="color: var(--primary);">Register</a></p>
                        </div>
                    </div>
                </section>
            `;
        }
        
        function showRegister() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 80px 0;">
                    <div class="container">
                        <div class="auth-container">
                            <h2 style="text-align: center; margin-bottom: 30px;">Register</h2>
                            <form onsubmit="handleRegister(event)">
                                <div class="form-group">
                                    <label>Email</label>
                                    <input type="email" id="registerEmail" class="form-control" placeholder="email@example.com" required>
                                </div>
                                <div class="form-group">
                                    <label>Password</label>
                                    <input type="password" id="registerPassword" class="form-control" placeholder="Min 6 characters" required>
                                </div>
                                <div class="form-group">
                                    <label>Confirm Password</label>
                                    <input type="password" id="registerConfirm" class="form-control" placeholder="Confirm password" required>
                                </div>
                                <button type="submit" class="btn" style="width: 100%;">Register</button>
                            </form>
                            <p style="text-align: center; margin-top: 20px;">Already have an account? <a href="#" onclick="showLogin()" style="color: var(--primary);">Login</a></p>
                        </div>
                    </div>
                </section>
            `;
        }
        
        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                alert('Login successful!');
            } catch (error) {
                alert('Login error: ' + error.message);
            }
        }
        
        async function handleRegister(e) {
            e.preventDefault();
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            
            if (password !== confirm) {
                alert('Passwords do not match!');
                return;
            }
            
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Save user data to Firestore
                await db.collection('users').doc(userCredential.user.uid).set({
                    email: email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    lastLogin: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('Registration successful!');
            } catch (error) {
                alert('Registration error: ' + error.message);
            }
        }
        
        async function logout() {
            try {
                await auth.signOut();
                alert('Logged out successfully!');
            } catch (error) {
                alert('Logout error: ' + error.message);
            }
        }
        
        function showDashboard() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 80px 0;">
                    <div class="container">
                        <h2 style="text-align: center; margin-bottom: 40px;">Dashboard</h2>
                        <div class="dashboard-grid">
                            <div class="stat-card">
                                <h3>User Info</h3>
                                <p>Email: ${currentUser.email}</p>
                                <p>UID: ${currentUser.uid.substring(0, 10)}...</p>
                            </div>
                            <div class="stat-card">
                                <h3>Quick Actions</h3>
                                <button class="btn" onclick="testFirestore()" style="margin: 10px 0; width: 100%;">Test Firestore</button>
                                <button class="btn" onclick="logout()" style="margin: 10px 0; width: 100%;">Logout</button>
                            </div>
                        </div>
                        <div id="firestoreResult" style="margin-top: 30px;"></div>
                    </div>
                </section>
            `;
        }
        
        async function testFirestore() {
            const resultDiv = document.getElementById('firestoreResult');
            resultDiv.innerHTML = '<p>Testing Firestore...</p>';
            
            try {
                // Create test document
                await db.collection('test').add({
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    message: 'Hello from PGXL!',
                    userId: currentUser.uid
                });
                
                // Read documents
                const snapshot = await db.collection('test')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('timestamp', 'desc')
                    .limit(5)
                    .get();
                
                let html = '<h3>Firestore Test Results:</h3>';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    html += `<p>${data.timestamp?.toDate().toLocaleTimeString()} - ${data.message}</p>`;
                });
                
                resultDiv.innerHTML = html;
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
            }
        }
        
        function updateCopyrightYear() {
            document.getElementById('currentYear').textContent = new Date().getFullYear();
        }
        
        // Global functions
        window.showLogin = showLogin;
        window.showRegister = showRegister;
        window.logout = logout;
        window.showDashboard = showDashboard;
        window.testFirestore = testFirestore;
        window.handleLogin = handleLogin;
        window.handleRegister = handleRegister;
    </script>
</body>
</html>
