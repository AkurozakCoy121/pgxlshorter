<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PGXL - Modern Web Platform</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    
    <style>
        /* MODERN WHITE-BLUE THEME */
        :root {
            --primary: #1a73e8;
            --primary-dark: #0d47a1;
            --accent: #00bcd4;
            --white: #ffffff;
            --light: #f8f9fa;
            --dark: #202124;
            --gray: #5f6368;
        }
        
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--light); color: var(--dark); }
        
        /* Header */
        header { background: var(--white); padding: 1rem 0; box-shadow: 0 2px 10px rgba(0,0,0,0.1); }
        .navbar { max-width: 1200px; margin: 0 auto; padding: 0 20px; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.8rem; font-weight: 700; color: var(--primary-dark); }
        
        /* Hero */
        .hero { text-align: center; padding: 6rem 20px; background: linear-gradient(135deg, var(--primary), var(--primary-dark)); color: white; }
        .hero h1 { font-size: 3rem; margin-bottom: 1rem; }
        
        /* Buttons */
        .btn { display: inline-block; background: var(--primary); color: white; padding: 12px 24px; border-radius: 8px; text-decoration: none; border: none; cursor: pointer; font-weight: 600; }
        .btn:hover { background: var(--primary-dark); }
        
        /* Features */
        .features { padding: 4rem 20px; max-width: 1200px; margin: 0 auto; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 2rem; }
        .card { background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        
        /* Auth */
        .auth-container { max-width: 400px; margin: 0 auto; background: white; padding: 2rem; border-radius: 12px; box-shadow: 0 5px 20px rgba(0,0,0,0.1); }
        .form-group { margin-bottom: 1rem; }
        .form-control { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; }
        
        /* Footer */
        footer { background: var(--dark); color: white; padding: 3rem 20px; margin-top: 4rem; }
        
        @media (max-width: 768px) {
            .hero h1 { font-size: 2.2rem; }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <header>
        <div class="navbar">
            <div class="logo">üöÄ PGXL</div>
            <div id="navButtons">
                <!-- Buttons akan diisi JS -->
            </div>
        </div>
    </header>

    <!-- Main Content -->
    <main id="mainContent">
        <!-- Content akan diisi JS -->
    </main>

    <!-- Footer -->
    <footer>
        <div style="max-width: 1200px; margin: 0 auto; text-align: center;">
            <p>&copy; <span id="currentYear"></span> PGXL - Premium Growth Expansion Lab</p>
        </div>
    </footer>

    <!-- Firebase Config (External) -->
    <script src="firebase-config.js"></script>
    
    <!-- App Logic -->
    <script>
        // Inisialisasi Firebase dari config external
        let db, auth, currentUser = null;
        
        document.addEventListener('DOMContentLoaded', function() {
            try {
                // Initialize Firebase dengan config dari file terpisah
                const app = firebase.initializeApp(firebaseConfig);
                db = firebase.firestore();
                auth = firebase.auth();
                
                console.log("‚úÖ Firebase initialized");
                
                // Auth state listener
                auth.onAuthStateChanged((user) => {
                    currentUser = user;
                    renderApp();
                });
                
                // Render awal
                renderApp();
                
                // Update copyright year
                document.getElementById('currentYear').textContent = new Date().getFullYear();
                
            } catch (error) {
                console.error("‚ùå Firebase error:", error);
                renderFallbackUI();
            }
        });
        
        function renderApp() {
            const mainContent = document.getElementById('mainContent');
            const navButtons = document.getElementById('navButtons');
            
            if (currentUser) {
                // User logged in
                navButtons.innerHTML = `
                    <div style="display: flex; gap: 10px; align-items: center;">
                        <span style="color: var(--primary);">${currentUser.email}</span>
                        <button class="btn" onclick="logout()">Logout</button>
                    </div>
                `;
                
                mainContent.innerHTML = `
                    <section class="hero">
                        <h1>Welcome to PGXL!</h1>
                        <p>Hi ${currentUser.email}, you're logged in successfully.</p>
                        <button class="btn" onclick="showDashboard()" style="margin-top: 20px;">Go to Dashboard</button>
                    </section>
                    
                    <section class="features">
                        <h2 style="text-align: center; margin-bottom: 2rem;">Your Dashboard</h2>
                        <div class="grid">
                            <div class="card">
                                <h3>üìä Analytics</h3>
                                <p>View your usage statistics and performance metrics.</p>
                            </div>
                            <div class="card">
                                <h3>‚öôÔ∏è Settings</h3>
                                <p>Manage your account preferences and security settings.</p>
                            </div>
                            <div class="card">
                                <h3>üìà Reports</h3>
                                <p>Generate detailed reports and export your data.</p>
                            </div>
                        </div>
                    </section>
                `;
                
            } else {
                // User not logged in
                navButtons.innerHTML = `
                    <div style="display: flex; gap: 10px;">
                        <button class="btn" onclick="showLogin()">Login</button>
                        <button class="btn" onclick="showRegister()" style="background: white; color: var(--primary); border: 2px solid var(--primary);">Register</button>
                    </div>
                `;
                
                mainContent.innerHTML = `
                    <section class="hero">
                        <h1>Modern Web Platform</h1>
                        <p>Build scalable applications with Firebase backend and modern architecture.</p>
                        <button class="btn" onclick="showRegister()" style="margin-top: 20px;">Get Started Free</button>
                    </section>
                    
                    <section class="features">
                        <h2 style="text-align: center; margin-bottom: 2rem;">Why PGXL?</h2>
                        <div class="grid">
                            <div class="card">
                                <h3>üöÄ Fast Development</h3>
                                <p>Build full-stack apps in hours, not weeks with our pre-built components.</p>
                            </div>
                            <div class="card">
                                <h3>üîí Secure by Default</h3>
                                <p>Enterprise-grade security with automatic SSL and DDoS protection.</p>
                            </div>
                            <div class="card">
                                <h3>üìà Auto Scaling</h3>
                                <p>Handle from 10 to 10 million users without server management.</p>
                            </div>
                        </div>
                    </section>
                `;
            }
        }
        
        function renderFallbackUI() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section class="hero">
                    <h1>PGXL Platform</h1>
                    <p>Firebase configuration is required. Please check firebase-config.js</p>
                    <button class="btn" onclick="location.reload()" style="margin-top: 20px;">Reload Page</button>
                </section>
            `;
        }
        
        function showLogin() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 4rem 20px;">
                    <div class="auth-container">
                        <h2 style="text-align: center; margin-bottom: 1.5rem;">Login</h2>
                        <form onsubmit="handleLogin(event)">
                            <div class="form-group">
                                <input type="email" id="loginEmail" class="form-control" placeholder="Email" required>
                            </div>
                            <div class="form-group">
                                <input type="password" id="loginPassword" class="form-control" placeholder="Password" required>
                            </div>
                            <button type="submit" class="btn" style="width: 100%;">Login</button>
                        </form>
                        <p style="text-align: center; margin-top: 1rem;">Don't have an account? <a href="#" onclick="showRegister()" style="color: var(--primary);">Register</a></p>
                    </div>
                </section>
            `;
        }
        
        function showRegister() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 4rem 20px;">
                    <div class="auth-container">
                        <h2 style="text-align: center; margin-bottom: 1.5rem;">Register</h2>
                        <form onsubmit="handleRegister(event)">
                            <div class="form-group">
                                <input type="email" id="registerEmail" class="form-control" placeholder="Email" required>
                            </div>
                            <div class="form-group">
                                <input type="password" id="registerPassword" class="form-control" placeholder="Password (min 6 chars)" required>
                            </div>
                            <div class="form-group">
                                <input type="password" id="registerConfirm" class="form-control" placeholder="Confirm Password" required>
                            </div>
                            <button type="submit" class="btn" style="width: 100%;">Create Account</button>
                        </form>
                        <p style="text-align: center; margin-top: 1rem;">Already have an account? <a href="#" onclick="showLogin()" style="color: var(--primary);">Login</a></p>
                    </div>
                </section>
            `;
        }
        
        async function handleLogin(e) {
            e.preventDefault();
            const email = document.getElementById('loginEmail').value;
            const password = document.getElementById('loginPassword').value;
            
            try {
                await auth.signInWithEmailAndPassword(email, password);
                alert('Login successful!');
            } catch (error) {
                alert('Login error: ' + error.message);
            }
        }
        
        async function handleRegister(e) {
            e.preventDefault();
            const email = document.getElementById('registerEmail').value;
            const password = document.getElementById('registerPassword').value;
            const confirm = document.getElementById('registerConfirm').value;
            
            if (password !== confirm) {
                alert('Passwords do not match!');
                return;
            }
            
            try {
                const userCredential = await auth.createUserWithEmailAndPassword(email, password);
                
                // Save user data to Firestore
                await db.collection('users').doc(userCredential.user.uid).set({
                    email: email,
                    createdAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                alert('Registration successful!');
            } catch (error) {
                alert('Registration error: ' + error.message);
            }
        }
        
        async function logout() {
            try {
                await auth.signOut();
                alert('Logged out successfully!');
            } catch (error) {
                alert('Logout error: ' + error.message);
            }
        }
        
        function showDashboard() {
            const mainContent = document.getElementById('mainContent');
            mainContent.innerHTML = `
                <section style="padding: 4rem 20px;">
                    <div style="max-width: 800px; margin: 0 auto;">
                        <h2 style="text-align: center; margin-bottom: 2rem;">Dashboard</h2>
                        <div class="grid">
                            <div class="card">
                                <h3>User Info</h3>
                                <p>Email: ${currentUser.email}</p>
                                <p>UID: ${currentUser.uid.substring(0, 12)}...</p>
                            </div>
                            <div class="card">
                                <h3>Quick Actions</h3>
                                <button class="btn" onclick="testFirestore()" style="margin: 10px 0; width: 100%;">Test Database</button>
                                <button class="btn" onclick="logout()" style="margin: 10px 0; width: 100%;">Logout</button>
                            </div>
                        </div>
                        <div id="testResult" style="margin-top: 2rem;"></div>
                    </div>
                </section>
            `;
        }
        
        async function testFirestore() {
            const resultDiv = document.getElementById('testResult');
            resultDiv.innerHTML = '<p>Testing Firestore connection...</p>';
            
            try {
                // Test Firestore write
                await db.collection('test').add({
                    userId: currentUser.uid,
                    timestamp: firebase.firestore.FieldValue.serverTimestamp(),
                    message: 'Firestore test successful!'
                });
                
                // Test Firestore read
                const snapshot = await db.collection('test')
                    .where('userId', '==', currentUser.uid)
                    .orderBy('timestamp', 'desc')
                    .limit(3)
                    .get();
                
                let html = '<h3>Test Results:</h3>';
                snapshot.forEach(doc => {
                    const data = doc.data();
                    html += `<p>${data.timestamp?.toDate().toLocaleTimeString()} - ${data.message}</p>`;
                });
                
                resultDiv.innerHTML = html;
                alert('Firestore test successful!');
                
            } catch (error) {
                resultDiv.innerHTML = `<p style="color: red;">Error: ${error.message}</p>`;
                alert('Firestore test failed: ' + error.message);
            }
        }
        
        // Export functions to global scope
        window.showLogin = showLogin;
        window.showRegister = showRegister;
        window.logout = logout;
        window.showDashboard = showDashboard;
        window.testFirestore = testFirestore;
        window.handleLogin = handleLogin;
        window.handleRegister = handleRegister;
    </script>
</body>
</html>
